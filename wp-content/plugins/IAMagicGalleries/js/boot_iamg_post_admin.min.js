/*! ia-designer 09-02-2024 
Copyright Â© 2023 Information Aesthetics. All rights reserved.
This work is licensed under the GPL2, V2/ license.*/

window.addEventListener("load",function(){let e;const t=wp.i18n.__;let i=window.location.href,s=i.includes("post-new.php"),l=document.getElementById("save-post"),n=document.getElementsByName("publish")[0];s&&(n&&(n.disabled=!0),l&&(l.disabled=!0));const o=()=>{eve_ia.on(["ia","gui","created"],function(t){let i=document.getElementsByClassName("iamg-loading-gif")[0];i&&i.remove(),this.eve.once(["presenter","loaded"],function(t){let i=iamg_settings.gallery_properties;if(e=iamg_settings.id,!i.type)return;const s=i.type;let l=i.images||[];const n=i.requested_images||[],o=i.resource;let r,a;for(let e in i)i.hasOwnProperty(e)&&e.startsWith(s)&&((r=r||{})[e]=i[e]);a=function(e,t){const i=[];let s=t.length;for(let l,n=0;n<e.length;n++){l=e[n].title;for(let o=0;o<s;o++){let r=t[(n+o)%s];if(l===r.title){i.push({id:l+"_"+r.id,url:e[n].thumbnail.url,title:l});break}}}return i}(l,n),t.eve(["iamg","load_gallery_setup"],void 0,s,a,r,o)}.bind(void 0,this))(100)}),eve_ia.on(["global","iamg","gallery","save"],function(e){const o=this;let r=document.getElementsByName("post_title")[0].value;if(!r)return void o.eve("gui.alert",t("Please, enter gallery title")+".",[200,100],[t("OK")]);const a={command:"save",locator:e,title:r,post_id:iamg_settings.post_id,is_gallery_post:!0};o.comManager.wpCommand(a,function(e){let r={margin:{top:10,bottom:5,left:10,right:5}};if(e.error)return o.eve("gui.alert",t("Gallery was not saved successfully")+".",[220,70],[t("OK")],[],r),o.eve("gui.error",e.error),n&&(n.disabled=!1),void(l&&(l.disabled=!1));o.eve("gui.alert",t("Gallery is saved successfully")+".",[200,70],[t("OK")],[function(){s&&(i=i.replace(/post-new\.php.*/,"post.php?post="+iamg_settings.post_id+"&action=edit"),l&&(l.disabled=!1),l.click())}],r),n&&(n.disabled=!1)},function(e){o.eve("gui.error",t("Server Error Occurred"))})})};window.IA_Presenter_loader&&IA_Presenter_loader(iamg_settings.settings,void 0,iamg_settings.resources,{after_callback:o})});